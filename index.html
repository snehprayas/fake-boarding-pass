<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sneh Prayas Boarding Pass Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.0/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<style>
:root {
  --pink-100: #ffe6f0;
  --accent: #d63384;
  --accent-2: #ff6699;
  --perforation: #eaa1c3;
  --text: #000;
}
body {font-family:'Poppins',sans-serif;background:var(--pink-100);margin:0;padding:20px;display:flex;flex-direction:column;align-items:center;color:var(--text);}
.container{width:100%;max-width:1200px;}
h1.main-title{color:var(--accent);text-align:center;margin:0 0 20px;font-size:28px;font-weight:700;}
.gateway{background:#fff;border-radius:12px;padding:14px 16px;box-shadow:0 6px 18px rgba(0,0,0,0.06);margin-bottom:16px;display:flex;gap:12px;align-items:center;flex-wrap:wrap;justify-content:center;}
.gateway input{padding:10px 12px;border:2px solid #f7c7da;border-radius:8px;width:260px;}
.button{padding:10px 16px;border-radius:10px;background:linear-gradient(135deg,var(--accent-2),var(--accent));color:#fff;border:none;cursor:pointer;font-weight:700;}
.ticket{width:880px;max-width:95vw;border-radius:16px;overflow:hidden;background:var(--pink-100);box-shadow:0 12px 30px rgba(0,0,0,0.12);margin:18px auto;display:flex;position:relative;}
.ticket-header-global{position:absolute;left:0;right:0;top:0;height:56px;background:var(--accent);color:#fff;display:flex;align-items:center;font-weight:700;font-size:16px;z-index:2;}
.ticket-header-part{flex:1;display:flex;align-items:center;justify-content:center;padding:0 8px;}
.ticket-part{flex:1;padding:86px 18px 18px;text-align:center;position:relative;min-width:0;}
.ticket-part.small{flex:0.9;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding-top:72px;gap:8px;}
.info-label{display:block;font-size:12px;color:#555;font-weight:600;}
.info-value{font-weight:700;font-size:14px;color:#000;}
.top-booking{margin-top:-56px;padding-top:12px;width:100%;text-align:center;}
.booking-id{font-size:22px;font-weight:800;color:var(--accent);padding:6px 12px;background:rgba(255,255,255,0.9);border-radius:8px;display:inline-block;box-shadow:0 4px 10px rgba(0,0,0,0.06);}
.passenger-name{font-size:20px;font-weight:800;margin-top:6px;}
.two-col{display:flex;gap:12px;justify-content:center;margin-top:8px;}
.two-col .col{min-width:120px;}
.qr-wrapper{margin-top:12px;display:flex;align-items:center;justify-content:center;}
.qr-img{width:120px;height:120px;object-fit:contain;border-radius:6px;background:white;padding:6px;box-shadow:0 4px 14px rgba(0,0,0,0.06);}
.small-meta{font-size:12px;color:#444;margin-top:6px;}
.route{display:flex;gap:12px;align-items:center;justify-content:center;margin:12px 0;}
.station-name{flex:1;font-weight:800;font-size:18px;}
.train-img{width:60px;}
.ticket-part:not(:last-child){border-right:2px dashed var(--perforation);}
#hiddenRenderContainer{position:fixed;left:-9999px;top:-9999px;visibility:hidden;}
.progress{margin-top:12px;background:#fff;padding:10px;border-radius:8px;box-shadow:0 6px 16px rgba(0,0,0,0.06);}
.progress-bar{height:12px;background:#eee;border-radius:8px;overflow:hidden;}
.progress-bar>i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));}
.status-text{margin-top:8px;font-size:13px;color:#333;}
</style>
</head>
<body>
<div class="container">
<h1 class="main-title">SNEH PRAYAS — BOARDING PASS GENERATOR</h1>
<div class="gateway">
<input id="bookingId" placeholder="Enter Booking ID (e.g. AST001B03R038)">
<button class="button" onclick="generateTicket()">Generate Ticket</button>
<button class="button" onclick="downloadAllTickets()">Download ALL Tickets</button>
</div>
<div id="ticketContainer"></div>
<div id="hiddenRenderContainer"></div>
<div id="progressArea" class="progress" style="display:none;">
<div class="progress-bar"><i id="progressFill"></i></div>
<div class="status-text" id="progressText">Preparing...</div>
</div>
</div>
<script src="passengers.js"></script>
<script>

// Booking ID -> QR mapping
const qrMap = {
  "AST001B03R038": "ALI363", "AST002B03R038": "ALI364", "AST003B03R038": "ALI365", "AST004B03R037": "ALI368", "AST005B08R078": "ALI369", "AST006B08R078": "ALI370", "AST007B08R078": "ALI371", "AST008B13R051": "BBK341", "AST009B13R053": "BBK342", "AST010B08R080": "BBK343", "AST011B08R081": "BBK344", "AST012B12R066": "BBK345", "AST013B05R114": "BBK346", "AST014B05R111": "BBK347", "AST015B12R066": "BBK348", "AST016B17R026": "BBK349", "AST017B08R080": "BBK350", "AST018B08R081": "BBK351", "AST019B10R094": "BBK352", "AST020B12R070": "BBK353", "AST021B12R067": "BBK354", "AST022B12R067": "BBK355", "AST023B10R093": "BBK356", "AST024B12R067": "BBK357", "AST025B12R068": "BBK358", "AST026B12R068": "BBK359", "AST027B03R024": "BBK360", "AST028B03R041": "BBK361", "AST029B12R070": "BBK362", "AST030B02R015": "BBZ316", "AST031B11R082": "BBZ317", "AST032B12R069": "BBZ318", "AST033B12R069": "BBZ319", "AST034B13R053": "BBZ320", "AST035B10R093": "BBZ321", "AST036B04R024": "BBZ322", "AST037B15R125": "BBZ323", "AST038B09R098": "BBZ324", "AST039B09R098": "BBZ325", "AST040B01R003": "BBZ326", "AST041B09R098": "BBZ327", "AST042B12R071": "BBZ328", "AST043B11R083": "BBZ330", "AST044B11R083": "BBZ331", "AST045B11R083": "BBZ332", "AST046B11R089": "BBZ333", "AST047B01R004": "BBZ334", "AST048B12R072": "BBZ335", "AST049B12R069": "BBZ336", "AST050B04R017": "BBZ339", "AST051B01R004": "BBZ340", "AST052B07R135": "CHOW395", "AST053B07R136": "CHOW396", "AST054B02R014": "CHOW399", "AST055B12R070": "CHOW402", "AST056B01R003": "CHOW403", "AST057B01R001": "CHOW404", "AST058B01R003": "CHOW405", "AST059B01R002": "CHOW406", "AST060B01R002": "CHOW407", "AST061B01R002": "CHOW408", "AST062B05R119": "CHOW409", "AST063B05R120": "CHOW410", "AST064B05R119": "CHOW411", "AST065B05R120": "CHOW412", "AST066B15R125": "IND154", "AST067B15R127": "IND155", "AST068B17R027": "IND156", "AST069B17R027": "IND157", "AST070B17R027": "IND158", "AST071B12R072": "IND159", "AST072B12R072": "IND160", "AST073B11R082": "IND161", "AST074B12R073": "IND162", "AST075B06R108": "IND163", "AST084B04R019": "IND172", "AST085B04R022": "IND173", "AST086B12R071": "IND174", "AST087B11R082": "IND175", "AST096B08R077": "IND185", "AST097B08R077": "IND186", "AST098B08R077": "IND187", "AST101B14R060": "IND190", "AST102B14R060": "IND191", "AST103B14R060": "IND192", "AST104B06R110": "IND193", "AST105B06R111": "IND194", "AST106B02R009": "IND195", "AST107B12R073": "IND196", "AST108B01R006": "KAN372", "AST109B01R007": "KAN373", "AST110B11R085": "KAN374", "AST111B11R086": "KAN375", "AST112B04R019": "KAN376", "AST113B04R024": "KAN377", "AST114B04R021": "KAN378", "AST115B06R114": "KAN379", "AST116B06R113": "KAN380", "AST118B06R110": "KAN384", "AST119B06R113": "KAN385" };

function generateTicket() {
  const bookingId = document.getElementById('bookingId').value.trim();
  const p = passengers[qrMap[bookingId]];
  if(!p){alert("No booking found!");return;}
  const qrId = qrMap[bookingId];
  document.getElementById("ticketContainer").innerHTML = renderTicketHTML(bookingId, p, qrId);
}

function renderTicketHTML(bookingId,p,qrId){
return `<div class="ticket" id="ticket">
<div class="ticket-header-global">
<div class="ticket-header-part">SNEH PRAYAS</div>
<div class="ticket-header-part">RETURN PASS</div>
<div class="ticket-header-part">ONWARD PASS</div>
</div>
<div class="ticket-part small">
<div class="booking-label">Booking ID</div>
<div class="booking-id">${bookingId}</div>
<div class="booking-label">Name</div>
<div class="passenger-name">${p.name}</div>
<div class="two-col">
<div class="col"><div class="info-label">Phone</div><div class="info-value">${p.phone||'—'}</div></div>
<div class="col"><div class="info-label">Gender</div><div class="info-value">${p.gender||'—'}</div></div>
</div>
<div class="qr-wrapper"><img src="${qrId}_QR.png" class="qr-img" alt="QR for ${qrId}"></div>
</div>
<div class="ticket-part">
<div class="info-block"><span class="info-label">Train</span><span class="info-value">${p.return.train}</span></div>
<div class="route"><div class="station-name">${p.return.from}</div><img src="train-right.png" class="train-img"><div class="station-name">${p.return.to}</div></div>
<div class="two-col">
<div class="col"><div class="info-label">Date</div><div class="info-value">${p.return.date}</div></div>
<div class="col"><div class="info-label">Time</div><div class="info-value">${p.return.time}</div></div>
</div>
<div class="two-col">
<div class="col"><div class="info-label">Coach</div><div class="info-value">${p.return.coach}</div></div>
<div class="col"><div class="info-label">Seat</div><div class="info-value">${p.return.seat}</div></div>
</div>
</div>
<div class="ticket-part">
<div class="info-block"><span class="info-label">Train</span><span class="info-value">${p.onward.train}</span></div>
<div class="route"><div class="station-name">${p.onward.from}</div><img src="train-right.png" class="train-img"><div class="station-name">${p.onward.to}</div></div>
<div class="two-col">
<div class="col"><div class="info-label">Date</div><div class="info-value">${p.onward.date}</div></div>
<div class="col"><div class="info-label">Time</div><div class="info-value">${p.onward.time}</div></div>
</div>
<div class="two-col">
<div class="col"><div class="info-label">Coach</div><div class="info-value">${p.onward.coach}</div></div>
<div class="col"><div class="info-label">Seat</div><div class="info-value">${p.onward.seat}</div></div>
</div>
</div>
</div>`;
}

async function downloadAllTickets(){
const zip=new JSZip();
const container=document.getElementById('hiddenRenderContainer');
container.innerHTML='';
document.getElementById('progressArea').style.display='block';
let idx=0;
const total=Object.keys(qrMap).length;
for(const booking of Object.keys(qrMap)){
const p=passengers[qrMap[booking]];
if(!p) continue;
const html=renderTicketHTML(booking,p,qrMap[booking]);
const div=document.createElement('div');
div.innerHTML=html;
container.appendChild(div);
const canvas=await html2canvas(div,{scale:3});
const imgData=canvas.toDataURL("image/png");
zip.file(`${booking}.png`, imgData.split(',')[1], {base64:true});
idx++;
document.getElementById('progressFill').style.width=`${Math.round(idx/total*100)}%`;
document.getElementById('progressText').innerText=`Generating ${idx}/${total} tickets...`;
container.removeChild(div);
}
zip.generateAsync({type:"blob"}).then(content=>{saveAs(content,"all_boarding_passes.zip");document.getElementById('progressArea').style.display='none';});
}
</script>
</body>
</html>
